Assumptions

- browser
  - support `atob` and `btoa` for browsers
  - support `Buffer` for non-browsers
  - support `crypto.subtle.digest`
